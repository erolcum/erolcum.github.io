---
layout: post
title: Arduino ve PureBasic HaberleÅŸmesi 1 - LED YAKMA
---

Herkese merhabalar ğŸ‘‹ Projelerinizi bilgisayar Ã¼zerinden kendi tasarladÄ±ÄŸÄ±nÄ±z bir arayÃ¼zle kontrol etmek ister misiniz ? Bu yazÄ±da sizlerle yeni bir seriye baÅŸlÄ±yoruz. **Seri haberleÅŸme** yardÄ±mÄ±yla ve **PureBasic** kullanarak oluÅŸturduÄŸumuz arayÃ¼zlerle projelerimizi kontrol etmeyi ve veri okumayÄ± Ã¶ÄŸreneceÄŸiz. GeliÅŸtirdiÄŸimiz arayÃ¼zlerle Arduino projelerimizi ve PB Ã¶ÄŸrenme serÃ¼venini Ã§ok daha eÄŸlenceli hale getireceÄŸiz. 

En basit tanÄ±mÄ±yla seri iletiÅŸim dijital bilginin tek bir hat Ã¼zerinden ardÄ± sÄ±ra taÅŸÄ±nmasÄ±dÄ±r, yani seri iletiÅŸimde bir kerede sadece bir bit iletilir, 1 veya 0..<br><br>

![_config.yml]({{ site.baseurl }}/images/ledYak.jpg)<br>Ã‡alÄ±ÅŸmayan devre ÅŸemasÄ± ğŸ˜„ <br><br>

AÅŸaÄŸÄ±daki kodu Arduinoâ€™ya yÃ¼klÃ¼yoruz..<br><br>

```arduino
void setup() {
  pinMode(8, OUTPUT);
  Serial.begin(19200);
}

void loop() {
  if(Serial.available())
  {
    char c = Serial.read();
    if(c == '1')
    {
    digitalWrite(8,HIGH);
    Serial.println("LED IS ON");
    }
    else if(c == '0')
    {
    digitalWrite(8,LOW);
    Serial.println("LED IS OFF");
    }
  }
}
```
<br>
Arduino IDE'de AraÃ§lar â¡ï¸ Seri Port EkranÄ± menÃ¼sÃ¼nden, aÅŸaÄŸÄ±daki pencereyi aÃ§Ä±yoruz. Arduino'ya 1 yollarsak led yanacak, 0 yollarsak sÃ¶necektir.<br><br>

 ![image](https://github.com/user-attachments/assets/8cefbe0b-5e05-4e66-a6c8-0383dfc46dbf)
<br><br>

>Bu iÅŸleri yapmak iÃ§in [Arduino IDE 1.8.19](https://downloads.arduino.cc/arduino-1.8.19-windows.zip) sÃ¼rÃ¼mÃ¼nÃ¼ indirdim. (Gerekenden daha bÃ¼yÃ¼k yazÄ±lÄ±mlarÄ± bilgisayara yÃ¼kleyerek, onu kastÄ±rmaya oldum olasÄ± karÅŸÄ± Ã§Ä±kmÄ±ÅŸÄ±mdÄ±r. O yÃ¼zden Ä±srarla, son sÃ¼rÃ¼m olan 2.3.2'yi indirmiyorum.) PureBasic son sÃ¼rÃ¼m Demo programÄ±nÄ±, gÃ¶nÃ¼l rahatlÄ±ÄŸÄ±yla [buradan](https://www.purebasic.com/download.php) indirebilirsiniz.. BilgisayarÄ±nÄ±z, Windows ise 64-bit sÃ¼rÃ¼mÃ¼ indirebilirsiniz.. Tabii, Mac OS veya Linux kullanÄ±yorsanÄ±z, uygun sÃ¼rÃ¼mÃ¼ indiriniz. PB kurulum dosyasÄ±, Arduino IDE'den daha kÃ¼Ã§Ã¼k farkettiyseniz. PB Demo ile en fazla 800 satÄ±r bÃ¼yÃ¼klÃ¼ÄŸÃ¼nde bir program yazabilirsiniz. Bu da, bu tip projeler iÃ§in gayet yeterli bir satÄ±r sayÄ±sÄ±dÄ±r..

<br>

Bu Arduino kodu, ne iÅŸe yarayacak, Ã§ok basit demeyin. Burada amacÄ±mÄ±z PB'i tanÄ±mak olsa da bu kodu bir projede kullanmÄ±ÅŸtÄ±k. KonveyÃ¶r bantta ilerleyen Ã¼rÃ¼nlerin Ã¼zerine etiketleme iÃ§in yaz ve uygula makinasÄ± yerleÅŸtirmiÅŸtik. Makinadan geÃ§en, etiketi uygulanan Ã¼rÃ¼nler sonrasÄ±nda bir barkod okuyucunun altÄ±ndan geÃ§iyordu. Barkod okununca, bu bilgi pc'de bulunan SQL sunucuya kaydediliyordu. Barkod'un okunamamasÄ± durumunda, konveyÃ¶rÃ¼n durmasÄ± gerekir. Ä°ÅŸte bu noktada, Arduino'ya ÅŸemadaki led yerine bir SSR baÄŸlamÄ±ÅŸtÄ±m. SSR Ã§Ä±kÄ±ÅŸÄ±nÄ± da konveyÃ¶r motorunun sÃ¼rÃ¼cÃ¼sÃ¼ne baÄŸladÄ±k. Bu sayede, pc'de yazÄ±lÄ±m geliÅŸtiren arkadaÅŸ konveyÃ¶rÃ¼ durdurup, harekete geÃ§irebiliyordu. SSR, yerine bir rÃ¶le de baÄŸlanabilirdi. Bu tip iÅŸlerde, normalde PLC kullanÄ±lÄ±r.. Bir tane kontak iÃ§in de PLC'ye gerek yok diye dÃ¼ÅŸÃ¼nmÃ¼ÅŸtÃ¼m.

AÅŸaÄŸÄ±daki kodu PB IDEâ€™ye kopyalayÄ±p yapÄ±ÅŸtÄ±rÄ±n.. Ã–ncesinde **New** butonuna basarak boÅŸ bir sayfa aÃ§Ä±n. ArtÄ±k Arduino IDE'yi kapatabilirsiniz. Ã‡Ã¼nkÃ¼, seri portu, aynÄ± anda ancak bir program kullanabilir..  <br><br>

```pb
EnableExplicit

Enumeration
  #win_main
  #txt
  #txt_status
  #btn_on
  #btn_off
  #cmb_comPort
  #serial_port_nr
EndEnumeration

Global PortsFound = 0, Event, COMPort.s="", DataReceived.s
Global StartTime, Timeout = 1000, Result
Global *Buffer = AllocateMemory(128)

#FLAGS = #PB_Window_SystemMenu | #PB_Window_ScreenCentered
OpenWindow(#win_main, 0, 0, 200, 180, "Arduino LED control", #FLAGS) 
ComboBoxGadget(#cmb_comPort, 110, 15, 80, 23)

TextGadget(#txt, 10, 25, 280, 20, "Serial Port :")
TextGadget(#txt_status, 0, 140, 200, 40, "Status comes from Arduino", #PB_Text_Center)
ButtonGadget(#btn_on, 10, 70, 80, 50, "YAK")
ButtonGadget(#btn_off, 110, 70, 80, 50, "LED OFF")


Procedure Find_Ports()
  Protected i
  For i = 0 To 255
    COMPort="COM"+Str(i+1)
    If OpenSerialPort(i, COMPort, 19200, 0, 8, 1, #PB_SerialPort_NoHandshake, 1, 1)        
      AddGadgetItem(#cmb_comPort,-1, COMPort)
      CloseSerialPort(i) 
    EndIf
  Next
  PortsFound=1
EndProcedure


Procedure Port_Control()
  If  IsSerialPort(#serial_port_nr) : CloseSerialPort(#serial_port_nr) : EndIf
  
  COMPort = GetGadgetText(#cmb_comPort)
  If COMPort = ""
    SetGadgetText(#txt_status, "First select port !")
    ProcedureReturn #False
  Else
    If IsSerialPort(#serial_port_nr); if port open
      ProcedureReturn #True
    Else                            ; if port closed
      OpenSerialPort(#serial_port_nr, COMPort, 19200, 0, 8, 1, #PB_SerialPort_NoHandshake, 1, 1)
      SetGadgetText(#txt_status, "Port is open.." + #LF$ + "Wait 2-3 secs..")
      
      If IsSerialPort(#serial_port_nr)
        ProcedureReturn #True
      Else
        MessageRequester("Error","Port can't be opened !", #PB_MessageRequester_Error)
        ProcedureReturn #False
      EndIf 
    EndIf     
  EndIf
EndProcedure


Procedure Receive_Response()
  Repeat
    Event = WaitWindowEvent(20)
    Result = AvailableSerialPortInput(#serial_port_nr)      
    If Result 
      ;While Result 
      ReadSerialPortData(#serial_port_nr, *Buffer, Result) 
      DataReceived = PeekS(*Buffer, -1, #PB_Ascii)
      ;Result = AvailableSerialPortInput(#serial_port_nr) 
      ;Wend
      SetGadgetText(#txt_status, DataReceived)
      Break 
    EndIf
    Delay(1)  ; Let system do other things 
  Until ElapsedMilliseconds() - StartTime > Timeout
  
  If ElapsedMilliseconds() - StartTime > Timeout
    MessageRequester("Error","Usb cable is disconnected or.." + 
                             #LF$ + "Arduino isn't connected to the selected port or.." + 
                             #LF$ + "You didn't wait 2-3 seconds when the port was first opened..",
                     #PB_MessageRequester_Error)
    CloseSerialPort(#serial_port_nr)
  EndIf                 
EndProcedure


Repeat
  Event = WaitWindowEvent()
  
  If PortsFound=0
    Find_Ports()
  EndIf
  
  Select Event
    Case #PB_Event_Gadget
      Select EventGadget()
          
        Case #btn_on
          If IsSerialPort(#serial_port_nr)
            WriteSerialPortString(#serial_port_nr, "1", #PB_Ascii)
            StartTime = ElapsedMilliseconds()
            Receive_Response()
          Else 
            Port_Control()
          EndIf  
          
        Case #btn_off 
          If IsSerialPort(#serial_port_nr)
            WriteSerialPortString(#serial_port_nr, "0", #PB_Ascii)
            StartTime = ElapsedMilliseconds()
            Receive_Response()
          Else 
            Port_Control()
          EndIf 
          
        Case #cmb_comPort
          Port_Control()
          
      EndSelect
  EndSelect
Until Event = #PB_Event_CloseWindow

FreeMemory(*Buffer)
End

```
<br>

[Youtube'da izleyebilirsin..](https://youtu.be/6pM-lTXhI9Q)


